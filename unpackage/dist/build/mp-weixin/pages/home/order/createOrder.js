(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/order/createOrder"],{"3c1b":function(t,e,o){"use strict";(function(t){o("ced0");a(o("66fd"));var e=a(o("76cd"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},7666:function(t,e,o){"use strict";var a,s=function(){var t=this,e=t.$createElement;t._self._c},r=[];o.d(e,"b",(function(){return s})),o.d(e,"c",(function(){return r})),o.d(e,"a",(function(){return a}))},"76cd":function(t,e,o){"use strict";o.r(e);var a=o("7666"),s=o("c187");for(var r in s)"default"!==r&&function(t){o.d(e,t,(function(){return s[t]}))}(r);o("a8b8");var n,c=o("f0c5"),d=Object(c["a"])(s["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],n);e["default"]=d.exports},"984d":function(t,e,o){},a8b8:function(t,e,o){"use strict";var a=o("984d"),s=o.n(a);s.a},bc2d:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;o("2f62");var a=function(){o.e("components/uni-number-box").then(function(){return resolve(o("2bb9"))}.bind(null,o)).catch(o.oe)},s={components:{uniNumberBox:a},data:function(){return{url:this.$ctx,maskState:0,buyerMemo:"",payType:1,total:0,inviteCode:"",addressData:{name:"",mobile:"",addressName:"",address:"",area:"149",default:!1},shopData:{},type:1,userInfo:t.getStorageSync("userInfo"),cheapPurchaseCompanyId:"",acceptType:1}},onLoad:function(e){var o=t.getStorageSync("goodsData");0!==o.hot.length&&o.hot.forEach((function(t){t.acceptType="zq",t.fee=""})),0!==o.platform.length&&o.platform.forEach((function(t){var e=0;t.list.forEach((function(t){e+=t.goods.price*t.cpCart.goodsCount})),t.free=e>9900||9900===e})),this.shopData=o,this.calcTotal(),this.getDefaultAddr()},methods:{calcTotal:function(){var t=0;0!==this.shopData.hot.length&&this.shopData.hot.forEach((function(e){e.list.forEach((function(e){t+=e.goods.price*e.cpCart.goodsCount})),"dd"===e.acceptType&&(t+=100*e.fee.fee)})),0!==this.shopData.platform.length&&this.shopData.platform.forEach((function(e){e.list.forEach((function(e){t+=e.goods.price*e.cpCart.goodsCount}))})),0!==this.shopData.coupon.length&&this.shopData.coupon.forEach((function(e){e.list.forEach((function(e){t+=e.goods.value*e.cpCart.goodsCount}))})),this.total=Number((t/100).toFixed(2)),console.log(this.total,"ssssss")},getDefaultAddr:function(){var t=this,e={data:JSON.stringify({memberId:this.userInfo.id})};this.$getJson("/api/v2/vue/ydd/order/getDefaultAddr.jsp",e,"POST",(function(e){t.choiceAddress(e.data.addr)}))},choiceAddress:function(t){var e=this;this.addressData=t;var o=[];0!==this.shopData.hot.length&&this.shopData.hot.forEach((function(t){var e=0;t.list.forEach((function(t){e+=t.goods.price*t.cpCart.goodsCount})),o.push({storeId:t.store.storeId,price:e/100,type:1})})),this.$getJson("/api/v3/express/deliveryCost.jsp",{stores:JSON.stringify(o),receiver_addressId:this.addressData.id},"POST",(function(t){e.shopData.hot.forEach((function(e){t.data.success.forEach((function(t){e.store.storeId===t.storeId&&(e.fee=t)}))})),console.log(e.shopData),e.$forceUpdate()}))},changePayType:function(t){this.payType=t},changeAcceptType:function(t,e){this.shopData.hot.forEach((function(o){o.store.storeId==t&&(o.acceptType=e)})),this.calcTotal(),this.$forceUpdate()},submit:function(){var e=this;if(this.addressData){var o=0,a=[];0!==this.shopData.hot.length&&this.shopData.hot.forEach((function(t){var e={},s=[],r=0;"dd"==t.acceptType&&t.fee&&t.fee.fee&&(o+=100*t.fee.fee),t.list.forEach((function(t){r+=t.goods.price*t.cpCart.goodsCount,s.push({proId:t.goods.id,cartId:t.cpCart.id,specId:t.spec.id,num:t.cpCart.goodsCount,price:t.goods.price,shareId:"",shareUserId:0})})),"dd"===t.acceptType?(r+=100*t.fee.fee,e={storeId:t.store.storeId,dadaNo:t.fee.deliveryNo,yddNo:t.fee.origin_id,totalPay:r,productPay:r-t.fee.fee,paymentType:0,expFee:t.fee.fee,receivingWay:1,buyerMessage:t.buyerMessage,type:1,products:s}):e={storeId:t.store.storeId,dadaNo:"",yddNo:"",totalPay:r,productPay:r,paymentType:0,expFee:0,receivingWay:1,buyerMessage:t.buyerMessage,type:1,products:s},a.push(e)})),0!==this.shopData.platform.length&&this.shopData.platform.forEach((function(t){var e={},o=[],s=0;t.list.forEach((function(t){s+=t.goods.price*t.cpCart.goodsCount,o.push({proId:t.goods.id,cartId:t.cpCart.id,specId:t.spec.id,num:t.cpCart.goodsCount,price:t.goods.price,shareId:"",shareUserId:0})})),e={storeId:t.store.storeId,dadaNo:"",yddNo:"",totalPay:s,productPay:s,paymentType:0,expFee:0,receivingWay:1,buyerMessage:t.buyerMessage,type:2,products:o},a.push(e)})),0!==this.shopData.coupon.length&&this.shopData.coupon.forEach((function(t){var e={},o=[],s=0;t.list.forEach((function(t){s+=t.goods.value*t.cpCart.goodsCount,o.push({proId:t.goods.id,cartId:t.cpCart.id,specId:"",num:t.cpCart.goodsCount,price:t.goods.value,shareId:"",shareUserId:0})})),e={storeId:t.store.storeId,dadaNo:"",yddNo:"",totalPay:s,productPay:s,paymentType:0,expFee:0,receivingWay:1,buyerMessage:t.buyerMessage,type:3,products:o},a.push(e)}));var s={totalPay:100*this.total,postFee:o,paymentType:0,productPay:100*this.total-o,nickName:"",receiverId:this.addressData.id,receiverName:this.addressData.consignee,receiverMobile:this.addressData.mobile,lat:this.addressData.lat,lng:this.addressData.lng,orders:JSON.stringify(a)};console.log(e,"aaaaaa"),this.$getJson("/api/v3/order/add.jsp",s,"POST",(function(o){if(console.log(o),o.success){if(o.data.erros&&o.data.erros.length)return void t.showToast({icon:"none",title:o.data.erros[0].message});0==parseFloat(e.total)?t.navigateTo({url:"/pages/money/paySuccess"}):t.navigateTo({url:"/pages/money/pay?money="+e.total+"&sn="+o.data.paysn})}else t.showToast({title:o.message})}))}else t.showToast({title:"请选择地址"})},stopPrevent:function(){}}};e.default=s}).call(this,o("543d")["default"])},c187:function(t,e,o){"use strict";o.r(e);var a=o("bc2d"),s=o.n(a);for(var r in a)"default"!==r&&function(t){o.d(e,t,(function(){return a[t]}))}(r);e["default"]=s.a}},[["3c1b","common/runtime","common/vendor"]]]);