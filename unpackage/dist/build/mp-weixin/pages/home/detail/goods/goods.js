(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/detail/goods/goods"],{"38f9":function(t,e,o){"use strict";var s=o("e281"),n=o.n(s);n.a},6503:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=o("ebe4"),n=o("ebaf");function i(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,s)}return o}function r(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?i(Object(o),!0).forEach((function(e){c(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function c(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var a=function(){o.e("components/uniPop").then(function(){return resolve(o("33b1"))}.bind(null,o)).catch(o.oe)},d=function(){o.e("components/uni-popup/uni-popup").then(function(){return resolve(o("4a96"))}.bind(null,o)).catch(o.oe)},u={components:{uniPop:a,uniPopup:d},data:function(){return{store:{},options:{},banners:[],cartCount:"",specClass:"none",specSelected:[],productInfo:{},member:{},yddMember:t.getStorageSync("userInfo"),shareShow:!1,favorite:!1,posterShow:!1,ctx:this.$ctx,qrcodePaths:[],id:null,shareList:[],imgList:[],inviteCode:"",loginCode:"",mobile:t.getStorageSync("mobile"),desc:"",companyId:"",cheapPurchaseCompanyId:"",classification:"",optionType:"buy",specList:[],shareId:(0,s.randomString)(16),selectedSpec:{}}},onShareAppMessage:function(t){return this.$getJson("/api/v3/share/record.jsp",{shareId:this.shareId,storeId:202,busiType:4,busiValue:this.productInfo.id,platform:"wx"},"POST",(function(t){})),{title:"".concat(this.yddMember.realName,"推荐你购买").concat(this.productInfo.prodName),path:"/pages/home/detail/goods/goods?goodsId=".concat(this.id,"&storeId=202&shareId=").concat(this.shareId,"&shareUserId=").concat(this.yddMember.id),imageUrl:"".concat(this.ctx+this.productInfo.firstImg)}},onLoad:function(t){console.log(t),this.id=t.id,t.goodsId&&(this.id=t.goodsId,this.options=t),this.inviteCode=t.inviteCode},onShow:function(){this.options.goodsId&&(this.id=this.options.goodsId),this.loadData(),this.getCarts()},methods:{loadData:function(){var t=this,e={resourcesId:this.id};this.$getJson("/jsp/api/resources/resoucesInfo.jsp",e,"POST",(function(e){console.log("----list------------",e);new RegExp('/src="/(ydd1/)?upload/g'),new RegExp("<img","gi");e.data&&(t.productInfo=e.data.goods,t.productInfo=r({},e.data.goods,{intro:(0,n.dealRich)(e.data.goods.intro)}),t.specList=e.data.specs,t.selectedSpec=e.data.specs[0],t.banners=t.productInfo.bimgs.split(","),t.$getJson("/api/v2/vue/sqPlus/company/companyInfo.jsp",{data:JSON.stringify({companyId:t.productInfo.storeId})},"POST",(function(e){console.log(e,"ss"),t.store=r({},e.data.cjCompany,{storeId:e.data.cjCompany.id})})))})),this.$getJson("/api/v3/my/store/checkCollect.jsp",{storeId:202},"POST",(function(e){t.favorite=e.data}))},getCarts:function(){var e=this;t.getStorageSync("mobile")&&this.$getJson("/api/v2/vue/ydd/cart/getCartNumber.jsp",{},"POST",(function(t){t.data&&(e.cartCount=t.data)}))},kefu:function(){console.log("ssa"),1==this.productInfo.type&&wx.makePhoneCall({phoneNumber:this.store.serviceNo})},shareShowBtn:function(e){if(!t.getStorageSync("mobile"))return this.login(),this.$refs.popup.open(),void this.$refs.popup.clickClose(!0);this.shareShow=!this.shareShow,1==e&&this.getQrcode()},posterShowBtn:function(){this.posterShow=!this.posterShow},toggleSpec:function(){var t=this;"show"===this.specClass?(this.specClass="hide",setTimeout((function(){t.specClass="none"}),250)):"none"===this.specClass&&(this.specClass="show")},selectSpec:function(t){this.selectedSpec=t},getQrcode:function(){var t=this;this.$getJson("/api/v3/share/record.jsp",{shareId:this.shareId,storeId:202,busiType:4,busiValue:this.productInfo.id,platform:"wx"},"POST",(function(t){})),this.$getJson("/api/v3/qrCode/wxacode.jsp",{page:"/pages/home/detail/goods/goods",storeId:"202",shareUserId:this.yddMember.id,busiType:4,busiValue:this.productInfo.id,width:430},"GET",(function(e){console.log("----list------------",e),e.data&&(t.qrcodePaths=[],t.qrcodePaths[0]=t.url+e.data)}))},saveQrcode:function(e){var o=this;1==e?(o.qrcodePaths=[],this.productInfo.resources.smallBannerImgArr.forEach((function(t){o.qrcodePaths.push(o.url+t)}))):2==e&&(o.qrcodePaths=[],this.productInfo.resources.imgArr.forEach((function(t){o.qrcodePaths.push(o.url+t)}))),t.authorize({scope:"scope.writePhotosAlbum",success:function(){}}),t.previewImage({urls:this.qrcodePaths,longPressActions:{itemList:["发送给朋友","保存图片","收藏"],success:function(t){console.log("选中了第"+(t.tapIndex+1)+"个按钮,第"+(t.index+1)+"张图片")},fail:function(t){console.log("errerrerr",t)},complete:function(t){console.log("eeee",t)}}})},toFavorite:function(){var e=this;if(!t.getStorageSync("mobile"))return this.login(),this.$refs.popup.open(),void this.$refs.popup.clickClose(!0);var o=0,s="取消收藏成功";0==this.favorite&&(o=1,s="收藏成功"),this.$getJson("/api/v3/my/store/collect.jsp",{storeId:202,action:o},"POST",(function(o){e.favorite=!e.favorite,t.showToast({title:s,icon:"none"})}))},setOptionType:function(t){this.optionType=t,this.toggleSpec()},propComplete:function(){this.toggleSpec(),"buy"==this.optionType?this.buy():"cart"==this.optionType&&this.addCart()},buy:function(){console.log(this.productInfo);var e={hot:[],platform:[],coupon:[]};1==this.productInfo.type?e.hot.push({store:this.store,list:[{cpCart:{goodsCount:1},goods:this.productInfo,spec:{id:this.selectedSpec.id,sname:this.selectSpec.sname}}]}):2==this.productInfo.type&&e.platform.push({store:this.store,list:[{cpCart:{goodsCount:1},goods:this.productInfo,spec:{id:this.selectedSpec.id,sname:this.selectSpec.sname}}]}),t.setStorageSync("goodsData",e),t.navigateTo({url:"/pages/home/order/createOrder"})},addCart:function(){var e=this;if(console.log("s"),!t.getStorageSync("mobile"))return this.login(),this.$refs.popup.open(),void this.$refs.popup.clickClose(!0);var o={goodsId:this.productInfo.id,specId:this.selectedSpec.id,goodsType:this.productInfo.type};this.$getJson("/api/v2/vue/ydd/cart/addCart.jsp",{data:JSON.stringify(o)},"POST",(function(o){console.log("----res------------",o),1==o.data?(t.showToast({title:"加入成功",icon:"none"}),e.cartCount+=1):t.showToast({title:o.message,icon:"none"})}))},stopPrevent:function(){}}};e.default=u}).call(this,o("543d")["default"])},"84c6":function(t,e,o){"use strict";var s,n=function(){var t=this,e=t.$createElement,o=(t._self._c,parseInt(t.productInfo.sales)),s=parseInt(t.productInfo.stock);t.$mp.data=Object.assign({},{$root:{m0:o,m1:s}})},i=[];o.d(e,"b",(function(){return n})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return s}))},a386:function(t,e,o){"use strict";(function(t){o("ced0");s(o("66fd"));var e=s(o("c1cb"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},c1cb:function(t,e,o){"use strict";o.r(e);var s=o("84c6"),n=o("f5cb");for(var i in n)"default"!==i&&function(t){o.d(e,t,(function(){return n[t]}))}(i);o("38f9");var r,c=o("f0c5"),a=Object(c["a"])(n["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],r);e["default"]=a.exports},e281:function(t,e,o){},f5cb:function(t,e,o){"use strict";o.r(e);var s=o("6503"),n=o.n(s);for(var i in s)"default"!==i&&function(t){o.d(e,t,(function(){return s[t]}))}(i);e["default"]=n.a}},[["a386","common/runtime","common/vendor"]]]);