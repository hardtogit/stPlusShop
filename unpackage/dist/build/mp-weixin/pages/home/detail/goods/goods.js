(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/detail/goods/goods"],{"02d8":function(t,o,e){},"38f9":function(t,o,e){"use strict";var s=e("02d8"),n=e.n(s);n.a},6503:function(t,o,e){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=e("ebe4"),n=e("ebaf");function i(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{},s=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.forEach(function(o){r(t,o,e[o])})}return t}function r(t,o,e){return o in t?Object.defineProperty(t,o,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[o]=e,t}var c=function(){return e.e("components/uniPop").then(e.bind(null,"33b1"))},a=function(){return e.e("components/uni-popup/uni-popup").then(e.bind(null,"4a96"))},d={components:{uniPop:c,uniPopup:a},data:function(){return{store:{},options:{},banners:[],cartCount:"",specClass:"none",specSelected:[],productInfo:{},member:{},yddMember:t.getStorageSync("userInfo"),shareShow:!1,favorite:!1,posterShow:!1,ctx:this.$ctx,qrcodePaths:[],id:null,shareList:[],imgList:[],inviteCode:"",loginCode:"",mobile:t.getStorageSync("mobile"),desc:"",companyId:"",cheapPurchaseCompanyId:"",classification:"",optionType:"buy",specList:[],shareId:(0,s.randomString)(16),selectedSpec:{}}},onShareAppMessage:function(t){return this.$getJson("/api/v3/share/record.jsp",{shareId:this.shareId,storeId:202,busiType:4,busiValue:this.productInfo.id,platform:"wx"},"POST",function(t){}),{title:"".concat(this.yddMember.realName,"推荐你购买").concat(this.productInfo.prodName),path:"/pages/home/detail/goods/goods?goodsId=".concat(this.id,"&storeId=202&shareId=").concat(this.shareId,"&shareUserId=").concat(this.yddMember.id),imageUrl:"".concat(this.ctx+this.productInfo.firstImg)}},onLoad:function(t){console.log(t),this.id=t.id,t.goodsId&&(this.id=t.goodsId,this.options=t),this.inviteCode=t.inviteCode},onShow:function(){this.options.goodsId&&(this.id=this.options.goodsId),this.loadData(),this.getCarts()},methods:{loadData:function(){var t=this,o={resourcesId:this.id};this.$getJson("/jsp/api/resources/resoucesInfo.jsp",o,"POST",function(o){console.log("----list------------",o);new RegExp('/src="/(ydd1/)?upload/g'),new RegExp("<img","gi");o.data&&(t.productInfo=o.data.goods,t.productInfo=i({},o.data.goods,{intro:(0,n.dealRich)(o.data.goods.intro)}),t.specList=o.data.specs,t.selectedSpec=o.data.specs[0],t.banners=t.productInfo.bimgs.split(","),t.$getJson("/api/v2/vue/sqPlus/company/companyInfo.jsp",{data:JSON.stringify({companyId:t.productInfo.storeId})},"POST",function(o){console.log(o,"ss"),t.store=i({},o.data.cjCompany,{storeId:o.data.cjCompany.id})}))}),this.$getJson("/api/v3/my/store/checkCollect.jsp",{storeId:202},"POST",function(o){t.favorite=o.data})},getCarts:function(){var o=this;t.getStorageSync("mobile")&&this.$getJson("/api/v2/vue/ydd/cart/getCartNumber.jsp",{},"POST",function(t){t.data&&(o.cartCount=t.data)})},kefu:function(){console.log("ssa"),1==this.productInfo.type&&wx.makePhoneCall({phoneNumber:this.store.serviceNo})},shareShowBtn:function(o){if(!t.getStorageSync("mobile"))return this.login(),this.$refs.popup.open(),void this.$refs.popup.clickClose(!0);this.shareShow=!this.shareShow,1==o&&this.getQrcode()},posterShowBtn:function(){this.posterShow=!this.posterShow},toggleSpec:function(){var t=this;"show"===this.specClass?(this.specClass="hide",setTimeout(function(){t.specClass="none"},250)):"none"===this.specClass&&(this.specClass="show")},selectSpec:function(t){this.selectedSpec=t},getQrcode:function(){var t=this;this.$getJson("/api/v3/share/record.jsp",{shareId:this.shareId,storeId:202,busiType:4,busiValue:this.productInfo.id,platform:"wx"},"POST",function(t){}),this.$getJson("/api/v3/qrCode/wxacode.jsp",{page:"/pages/home/detail/goods/goods",storeId:"202",shareUserId:this.yddMember.id,busiType:4,busiValue:this.productInfo.id,width:430},"GET",function(o){console.log("----list------------",o),o.data&&(t.qrcodePaths=[],t.qrcodePaths[0]=t.url+o.data)})},saveQrcode:function(o){var e=this;1==o?(e.qrcodePaths=[],this.productInfo.resources.smallBannerImgArr.forEach(function(t){e.qrcodePaths.push(e.url+t)})):2==o&&(e.qrcodePaths=[],this.productInfo.resources.imgArr.forEach(function(t){e.qrcodePaths.push(e.url+t)})),t.authorize({scope:"scope.writePhotosAlbum",success:function(){}}),t.previewImage({urls:this.qrcodePaths,longPressActions:{itemList:["发送给朋友","保存图片","收藏"],success:function(t){console.log("选中了第"+(t.tapIndex+1)+"个按钮,第"+(t.index+1)+"张图片")},fail:function(t){console.log("errerrerr",t)},complete:function(t){console.log("eeee",t)}}})},toFavorite:function(){var o=this;if(!t.getStorageSync("mobile"))return this.login(),this.$refs.popup.open(),void this.$refs.popup.clickClose(!0);var e=0,s="取消收藏成功";0==this.favorite&&(e=1,s="收藏成功"),this.$getJson("/api/v3/my/store/collect.jsp",{storeId:202,action:e},"POST",function(e){o.favorite=!o.favorite,t.showToast({title:s,icon:"none"})})},setOptionType:function(t){this.optionType=t,this.toggleSpec()},propComplete:function(){this.toggleSpec(),"buy"==this.optionType?this.buy():"cart"==this.optionType&&this.addCart()},buy:function(){console.log(this.productInfo);var o={hot:[],platform:[],coupon:[]};1==this.productInfo.type?o.hot.push({store:this.store,list:[{cpCart:{goodsCount:1},goods:this.productInfo,spec:{id:this.selectedSpec.id,sname:this.selectSpec.sname}}]}):2==this.productInfo.type&&o.platform.push({store:this.store,list:[{cpCart:{goodsCount:1},goods:this.productInfo,spec:{id:this.selectedSpec.id,sname:this.selectSpec.sname}}]}),t.setStorageSync("goodsData",o),t.navigateTo({url:"/pages/home/order/createOrder"})},addCart:function(){var o=this;if(console.log("s"),!t.getStorageSync("mobile"))return this.login(),this.$refs.popup.open(),void this.$refs.popup.clickClose(!0);var e={goodsId:this.productInfo.id,specId:this.selectedSpec.id,goodsType:this.productInfo.type};this.$getJson("/api/v2/vue/ydd/cart/addCart.jsp",{data:JSON.stringify(e)},"POST",function(e){console.log("----res------------",e),1==e.data?(t.showToast({title:"加入成功",icon:"none"}),o.cartCount+=1):t.showToast({title:e.message,icon:"none"})})},stopPrevent:function(){}}};o.default=d}).call(this,e("543d")["default"])},"84c6":function(t,o,e){"use strict";var s,n=function(){var t=this,o=t.$createElement,e=(t._self._c,parseInt(t.productInfo.sales)),s=parseInt(t.productInfo.stock);t.$mp.data=Object.assign({},{$root:{m0:e,m1:s}})},i=[];e.d(o,"b",function(){return n}),e.d(o,"c",function(){return i}),e.d(o,"a",function(){return s})},a386:function(t,o,e){"use strict";(function(t){e("ced0"),e("921b");s(e("66fd"));var o=s(e("c1cb"));function s(t){return t&&t.__esModule?t:{default:t}}t(o.default)}).call(this,e("543d")["createPage"])},c1cb:function(t,o,e){"use strict";e.r(o);var s=e("84c6"),n=e("f5cb");for(var i in n)"default"!==i&&function(t){e.d(o,t,function(){return n[t]})}(i);e("38f9");var r,c=e("f0c5"),a=Object(c["a"])(n["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],r);o["default"]=a.exports},f5cb:function(t,o,e){"use strict";e.r(o);var s=e("6503"),n=e.n(s);for(var i in s)"default"!==i&&function(t){e.d(o,t,function(){return s[t]})}(i);o["default"]=n.a}},[["a386","common/runtime","common/vendor"]]]);